==============================================
ИЗМЕНЕНИЯ В АВТОФИТЕ EXCEL (28.10.2025)
==============================================

Исправлен алгоритм автоподгонки ширины столбцов в экспорте Excel.
Теперь ширина рассчитывается точно, как встроенный автофит в Excel.

ИЗМЕНЁННЫЕ ФАЙЛЫ:
------------------
1. schedule_excel_export.py - функция _autofit_columns() (строки 381-451)
2. test_autofit.py - функция autofit_columns() (строки 48-115)
3. export_from_schedule.py - блок автоширины (строки 109-146)

ЧТО БЫЛО ИСПРАВЛЕНО:
--------------------
✓ СТАРЫЙ АЛГОРИТМ:
  - Считал только количество символов (len(str(value)))
  - Не учитывал реальную ширину символов
  - Не учитывал размер и тип шрифта
  - Результат: слишком узкие или слишком широкие колонки

✓ НОВЫЙ АЛГОРИТМ:
  - Учитывает реальную ширину разных символов:
    * Широкие буквы (M, W, Ш, Щ) = 1.3
    * Заглавные буквы и кириллица = 1.2
    * Обычные символы = 1.0
    * Узкие символы (i, j, l, !,.) = 0.5
  
  - Учитывает размер шрифта (корректировка относительно базового размера 11)
  - Учитывает жирное начертание (+10% ширины)
  - Пропускает объединённые ячейки
  - Добавляет увеличенный padding (+3.5 единицы для гарантии)
  - Выравнивает все данные по центру
  - Ограничивает максимальную ширину (80 единиц)

ПРИМЕР РЕЗУЛЬТАТА (test_autofit.xlsx):
---------------------------------------
Колонка A (Время начала):     15.7 ед. ✓
Колонка B (Время окончания):  18.7 ед. ✓
Колонка C (Длительность):     15.7 ед. ✓
Колонка D (Продукт):          37.0 ед. ✓ ← Весь текст влезает!
Колонка E (Количество):       13.7 ед. ✓

Выравнивание: ПО ЦЕНТРУ
Padding: 3.5 (увеличен для гарантии)

ПРЕИМУЩЕСТВА:
-------------
✓ Ширина колонок точно соответствует содержимому
✓ Текст ГАРАНТИРОВАННО не обрезается (увеличен padding)
✓ Все данные выровнены по центру (красиво!)
✓ Файл выглядит профессионально
✓ Не нужно вручную подгонять колонки в Excel

==============================================

